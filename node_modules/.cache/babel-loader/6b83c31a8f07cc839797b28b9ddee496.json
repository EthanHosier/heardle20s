{"ast":null,"code":"import _regeneratorRuntime from\"/home/ethanh/Desktop/WORKING_TIMER_2010s_Heardle/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/ethanh/Desktop/WORKING_TIMER_2010s_Heardle/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/ethanh/Desktop/WORKING_TIMER_2010s_Heardle/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Layout from\"./components/Layout\";import useGlobal from\"./hooks/useGlobal\";import{useEffect,useState}from\"react\";import YouTube from'react-youtube';import raw from'./rsc/days-songs.txt';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var EMPTY_SCORES_OBJ={1:0,2:0,3:0,4:0,5:0,6:0,\"X\":0};var STARTING_POINT=1667606400000;var NUM_MS_IN_DAY=86400000;var OPTS={width:\"0\",height:\"0\"};function App(){var _useGlobal=useGlobal(),setHasPlayedToday=_useGlobal.setHasPlayedToday,setIsCorrect=_useGlobal.setIsCorrect,playerRef=_useGlobal.playerRef,correctSong=_useGlobal.correctSong,setCorrectSong=_useGlobal.setCorrectSong,setIsPlaying=_useGlobal.setIsPlaying,setDuration=_useGlobal.setDuration,duration=_useGlobal.duration;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),t=_useState2[0],setT=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),ytReady=_useState4[0],setYtReady=_useState4[1];var getCorrectSongIndex=function getCorrectSongIndex(){var today=new Date();return Math.floor((today.getTime()-STARTING_POINT)/NUM_MS_IN_DAY);};useEffect(function(){fetch(raw).then(function(r){return r.text();}).then(function(text){var s=JSON.parse(text);setCorrectSong(s[getCorrectSongIndex()]);});var lastStarted=new Date(localStorage.getItem(\"last-started\"));var lastPlayed=new Date(localStorage.getItem(\"last-played\"));var wonLast=JSON.parse(localStorage.getItem(\"won-last\"));if(isToday(lastPlayed)){setHasPlayedToday(true);resetStoredGuesses();setIsCorrect(wonLast);return;}if(!isToday(lastStarted)){resetStoredGuesses();}localStorage.setItem(\"last-started\",new Date());//check if scores in storage - if not, add them\nlocalStorage.getItem(\"scores\")==null&&localStorage.setItem(\"scores\",JSON.stringify(EMPTY_SCORES_OBJ));//reset guesses\n},[]);var isToday=function isToday(someDate){var today=new Date();return(someDate===null||someDate===void 0?void 0:someDate.getDate())==today.getDate()&&(someDate===null||someDate===void 0?void 0:someDate.getMonth())==today.getMonth()&&(someDate===null||someDate===void 0?void 0:someDate.getFullYear())==today.getFullYear();};var resetStoredGuesses=function resetStoredGuesses(){localStorage.setItem(\"guesses\",JSON.stringify(['','','','','','']));};var onReady=function onReady(){var ip=playerRef.current.internalPlayer;ip.playVideo();};var onStateChange=function onStateChange(e){if(e.data==2){setIsPlaying(false);return;}if(e.data==1){setIsPlaying(true);return;}if(e.data!=-1||ytReady)return;if(!t){setT(true);return;}var ip=playerRef.current.internalPlayer;var getDuration=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var durationPromise;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:durationPromise=playerRef.current.internalPlayer.getDuration();durationPromise.then(function(d){setDuration(Math.floor(d-correctSong.offset));setYtReady(true);});case 2:case\"end\":return _context.stop();}}},_callee);}))();};return/*#__PURE__*/_jsx(_Fragment,{children:correctSong?/*#__PURE__*/_jsxs(\"div\",{id:\"App\",children:[/*#__PURE__*/_jsx(YouTube,{opts:OPTS,onReady:onReady,videoId:correctSong.id,ref:playerRef,onStateChange:onStateChange,id:\"yt player\"}),!ytReady?/*#__PURE__*/_jsx(\"div\",{id:\"loader-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loader\"})}):/*#__PURE__*/_jsx(Layout,{})]}):/*#__PURE__*/_jsx(_Fragment,{})});}export default App;","map":{"version":3,"names":["Layout","useGlobal","useEffect","useState","YouTube","raw","EMPTY_SCORES_OBJ","STARTING_POINT","NUM_MS_IN_DAY","OPTS","width","height","App","setHasPlayedToday","setIsCorrect","playerRef","correctSong","setCorrectSong","setIsPlaying","setDuration","duration","t","setT","ytReady","setYtReady","getCorrectSongIndex","today","Date","Math","floor","getTime","fetch","then","r","text","s","JSON","parse","lastStarted","localStorage","getItem","lastPlayed","wonLast","isToday","resetStoredGuesses","setItem","stringify","someDate","getDate","getMonth","getFullYear","onReady","ip","current","internalPlayer","playVideo","onStateChange","e","data","getDuration","durationPromise","d","offset","id"],"sources":["/home/ethanh/Desktop/WORKING_TIMER_2010s_Heardle/src/App.js"],"sourcesContent":["import Layout from \"./components/Layout\";\nimport useGlobal from \"./hooks/useGlobal\";\nimport { useEffect,useState } from \"react\";\nimport YouTube from 'react-youtube';\nimport raw from './rsc/days-songs.txt';\n\n\nconst EMPTY_SCORES_OBJ = \n    {\n        1:0,\n        2:0,\n        3:0,\n        4:0,\n        5:0,\n        6:0,\n        \"X\":0\n    }\n\nconst STARTING_POINT = 1667606400000;\nconst NUM_MS_IN_DAY = 86400000;\nconst OPTS = {width: \"0\", height:\"0\"}\n\nfunction App() {\n\n  const {setHasPlayedToday,setIsCorrect,playerRef, correctSong, setCorrectSong, setIsPlaying, setDuration,duration} = useGlobal();\n  const [t,setT] = useState(false)\n  const [ytReady, setYtReady] = useState(false);\n\n\n  const getCorrectSongIndex = () =>{\n    const today = new Date();\n    return Math.floor((today.getTime() - STARTING_POINT) / NUM_MS_IN_DAY)\n  }\n\n  useEffect(() =>{\n\n    fetch(raw)\n    .then(r => r.text())\n    .then(text => {\n      let s = JSON.parse(text);\n      setCorrectSong(s[getCorrectSongIndex()])\n   });\n\n    const lastStarted = new Date(localStorage.getItem(\"last-started\"))\n    const lastPlayed = new Date(localStorage.getItem(\"last-played\"))\n    const wonLast = JSON.parse(localStorage.getItem(\"won-last\"));\n\n    if(isToday(lastPlayed)){\n        setHasPlayedToday(true);\n        resetStoredGuesses();\n        setIsCorrect(wonLast)\n        return\n    }\n\n    if(!isToday(lastStarted)){\n        resetStoredGuesses();\n    }\n\n    localStorage.setItem(\"last-started\", new Date())\n    \n    //check if scores in storage - if not, add them\n    localStorage.getItem(\"scores\") == null && localStorage.setItem(\"scores\", JSON.stringify(EMPTY_SCORES_OBJ))\n\n    //reset guesses\n  \n    \n  \n},[])\n\n\n  const isToday = (someDate) => {\n    const today = new Date()\n    return someDate?.getDate() == today.getDate() &&\n      someDate?.getMonth() == today.getMonth() &&\n      someDate?.getFullYear() == today.getFullYear()\n  }\n  const resetStoredGuesses = () =>{\n    localStorage.setItem(\"guesses\", JSON.stringify(['','','','','','']))\n}\n\n  const onReady = () =>{\n    const ip = playerRef.current.internalPlayer;\n    ip.playVideo();\n\n  }\n\n  const onStateChange =(e) =>{\n    if(e.data ==2){\n      setIsPlaying(false)\n      return\n    }\n    \n    \n    if(e.data == 1) {\n      setIsPlaying(true)\n      return\n    }\n    \n    if(e.data != -1 || ytReady) return\n    if(!t){\n      setT(true)\n      return\n   }\n\n   const ip = playerRef.current.internalPlayer;\n   const getDuration = (async() =>{\n    const durationPromise = playerRef.current.internalPlayer.getDuration()\n    durationPromise.then((d)=>{\n      setDuration(Math.floor(d - correctSong.offset))\n      setYtReady(true)\n    }\n    )})();\n   \n   \n\n  } \n\n  return ( \n    <>\n\n    {correctSong? \n    <div id=\"App\">\n\n      <YouTube opts={OPTS} onReady={onReady} videoId={correctSong.id} ref={playerRef} onStateChange={onStateChange} id=\"yt player\" />\n      {!ytReady\n      ?<div id=\"loader-container\"><div className=\"loader\"></div></div>\n      : <Layout />\n      }\n      \n    </div>\n    \n    : <></>\n}\n\n\n    </>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}
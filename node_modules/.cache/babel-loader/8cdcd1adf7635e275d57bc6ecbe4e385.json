{"ast":null,"code":"import _slicedToArray from\"/home/ethanh/Desktop/suitableForMobile.2010s-heardle-1.1/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Layout from\"./components/Layout\";import useGlobal from\"./hooks/useGlobal\";import{useEffect,useState}from\"react\";import YouTube from'react-youtube';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var EMPTY_SCORES_OBJ={1:0,2:0,3:0,4:0,5:0,6:0,\"X\":0};var OPTS={width:\"0\",height:\"0\"};function App(){var _useGlobal=useGlobal(),setHasPlayedToday=_useGlobal.setHasPlayedToday,setIsCorrect=_useGlobal.setIsCorrect,playerRef=_useGlobal.playerRef,CORRECT_SONG=_useGlobal.CORRECT_SONG;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),ytPlayerReady=_useState2[0],setYtPlayerReady=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];useEffect(function(){var lastStarted=new Date(localStorage.getItem(\"last-started\"));var lastPlayed=new Date(localStorage.getItem(\"last-played\"));var wonLast=JSON.parse(localStorage.getItem(\"won-last\"));if(isToday(lastPlayed)){setHasPlayedToday(true);resetStoredGuesses();setIsCorrect(wonLast);return;}if(!isToday(lastStarted)){resetStoredGuesses();}localStorage.setItem(\"last-started\",new Date());//check if scores in storage - if not, add them\nlocalStorage.getItem(\"scores\")==null&&localStorage.setItem(\"scores\",JSON.stringify(EMPTY_SCORES_OBJ));//reset guesses\n},[]);useEffect(function(){if(!ytPlayerReady)return;playerRef.current.internalPlayer.playVideo();},[ytPlayerReady]);var isToday=function isToday(someDate){var today=new Date();return(someDate===null||someDate===void 0?void 0:someDate.getDate())==today.getDate()&&(someDate===null||someDate===void 0?void 0:someDate.getMonth())==today.getMonth()&&(someDate===null||someDate===void 0?void 0:someDate.getFullYear())==today.getFullYear();};var resetStoredGuesses=function resetStoredGuesses(){localStorage.setItem(\"guesses\",JSON.stringify(['','','','','','']));};var onStateChange=function onStateChange(e){console.log(e);if(!isLoading||e.data!=-1)return;setIsLoading(false);};return/*#__PURE__*/_jsxs(\"div\",{id:\"App\",children:[/*#__PURE__*/_jsx(YouTube,{opts:OPTS,onReady:function onReady(){return setYtPlayerReady(true);},videoId:CORRECT_SONG.id,ref:playerRef,onStateChange:onStateChange}),isLoading?/*#__PURE__*/_jsx(\"div\",{id:\"loader-container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"loader\"})}):/*#__PURE__*/_jsx(Layout,{})]});}export default App;","map":{"version":3,"names":["Layout","useGlobal","useEffect","useState","YouTube","EMPTY_SCORES_OBJ","OPTS","width","height","App","setHasPlayedToday","setIsCorrect","playerRef","CORRECT_SONG","ytPlayerReady","setYtPlayerReady","isLoading","setIsLoading","lastStarted","Date","localStorage","getItem","lastPlayed","wonLast","JSON","parse","isToday","resetStoredGuesses","setItem","stringify","current","internalPlayer","playVideo","someDate","today","getDate","getMonth","getFullYear","onStateChange","e","console","log","data","id"],"sources":["/home/ethanh/Desktop/suitableForMobile.2010s-heardle-1.1/src/App.js"],"sourcesContent":["import Layout from \"./components/Layout\";\nimport useGlobal from \"./hooks/useGlobal\";\nimport { useEffect,useState } from \"react\";\nimport YouTube from 'react-youtube';\n\nconst EMPTY_SCORES_OBJ = \n    {\n        1:0,\n        2:0,\n        3:0,\n        4:0,\n        5:0,\n        6:0,\n        \"X\":0\n    }\n\nconst OPTS = {width: \"0\", height:\"0\"}\n\n\nfunction App() {\n\n  const {setHasPlayedToday,setIsCorrect,playerRef, CORRECT_SONG} = useGlobal();\n  const [ytPlayerReady, setYtPlayerReady] = useState(false) \n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() =>{\n    const lastStarted = new Date(localStorage.getItem(\"last-started\"))\n    const lastPlayed = new Date(localStorage.getItem(\"last-played\"))\n    const wonLast = JSON.parse(localStorage.getItem(\"won-last\"));\n\n    if(isToday(lastPlayed)){\n        setHasPlayedToday(true);\n        resetStoredGuesses();\n        setIsCorrect(wonLast)\n        return\n    }\n\n    if(!isToday(lastStarted)){\n        resetStoredGuesses();\n    }\n\n    localStorage.setItem(\"last-started\", new Date())\n    \n    //check if scores in storage - if not, add them\n    localStorage.getItem(\"scores\") == null && localStorage.setItem(\"scores\", JSON.stringify(EMPTY_SCORES_OBJ))\n\n    //reset guesses\n\n},[])\n\n  useEffect(()=>{\n    if(!ytPlayerReady) return;\n    playerRef.current.internalPlayer.playVideo();\n  },[ytPlayerReady])\n\n  const isToday = (someDate) => {\n    const today = new Date()\n    return someDate?.getDate() == today.getDate() &&\n      someDate?.getMonth() == today.getMonth() &&\n      someDate?.getFullYear() == today.getFullYear()\n  }\n  const resetStoredGuesses = () =>{\n    localStorage.setItem(\"guesses\", JSON.stringify(['','','','','','']))\n}\n\n  const onStateChange = (e) =>{\n    console.log(e)\n    if (!isLoading || e.data !=-1) return;\n    setIsLoading(false)\n  }\n\n\n\n  return ( \n    <div id=\"App\">\n      <YouTube opts={OPTS} onReady={() => setYtPlayerReady(true)} videoId={CORRECT_SONG.id} ref={playerRef} onStateChange={onStateChange}  />\n      {/*TODO: update so that autoplays, then only sets to loaded when state = 1 */}\n      {isLoading\n      ?<div id=\"loader-container\"><div className=\"loader\"></div></div>\n      : <Layout />\n      }\n      \n    </div>\n    );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}